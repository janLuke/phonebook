(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{30:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),r=n.n(c),o=n(4),s=n.n(o),i=(n(30),n(13)),l=n.n(i),u=n(8),d=n(23),j=n(2),b=n(5),m=(n(32),n(9)),h=n.n(m),f="/api/contacts";var O=n(6),p=n(11),v='A phone number can only contain digits separated by a single space or "-". Optionally, it can start with "+".',x=function(e){return e[0].toUpperCase()+e.slice(1)},g=function(e){return e.trim().toLowerCase()},N=function(e){return e.trim().split(/\s+/).map(x).join(" ")},y=function(e,t){return e=g(e),t.find((function(t){return g(t.name)===e}))},C=function(e){var t=e.type,n=e.label,c=e.id,r=e.value,o=e.onChange,s=e.error,i=e.inputRef,l=Object(p.a)(e,["type","label","id","value","onChange","error","inputRef"]);return Object(a.jsxs)("div",{className:"FormField",children:[Object(a.jsxs)("label",{htmlFor:c,className:"FormField__label",children:[n,":"]}),Object(a.jsx)("input",Object(O.a)({ref:i,className:s?"in-error":void 0,id:c,type:t,value:r,onChange:o},l)),s&&Object(a.jsx)("div",{className:"FormField__error",children:s})]})};function w(e){var t=e.contacts,n=e.onAddNew,r=e.onUpdate,o=Object(c.useState)(""),s=Object(j.a)(o,2),i=s[0],l=s[1],u=Object(c.useState)(""),d=Object(j.a)(u,2),b=d[0],m=d[1],h=Object(c.useState)(""),f=Object(j.a)(h,2),p=f[0],x=f[1],w=Object(c.useState)(""),F=Object(j.a)(w,2),_=F[0],D=F[1],S=Object(c.useState)(null),k=Object(j.a)(S,2),I=k[0],L=k[1],A=Object(c.useState)(null),E=Object(j.a)(A,2),T=E[0],B=E[1];Object(c.useEffect)((function(){var e=y(i,t);B(e)}),[i,t]);var M=!i||!p||b||_;return Object(a.jsxs)("form",{className:"ContactForm",children:[Object(a.jsx)(C,{inputRef:L,label:"Name",id:"name-field",value:i,error:b,onChange:function(e){var t=e.target.value;l(t)}}),Object(a.jsx)(C,{label:"Phone number",id:"phone-field",value:p,error:_,onChange:function(e){var t,n=e.target.value,a=(t=(t=n.trim()).trim()).length>20?"Too long! Max 20 characters.":t?t.match(/^[+]?([0-9]+[- ]?)*$/)?null:v:null;D(a),x(n)}}),Object(a.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault();var a=function(e,t,n){return(e=g(e))?n&&y(e,t)?"This name already exists in the phonebook!":"":"Empty name!"}(i,t,!T),c=function(e){return(e=e.trim()).length>20?"Too long! Max 20 characters.":e.replace(/\D/g,"").length<8?"Too short! Must contain at least 8 digits!":e.match(/^[+]?[0-9]+([ -][0-9]+)*$/)?null:v}(p.trim());a||c?(m(a),D(c)):(T?p!==T.phoneNumber&&r(Object(O.a)(Object(O.a)({},T),{},{phoneNumber:p})):n({name:N(i),phoneNumber:p.trim()}),l(""),x(""),I.focus())},disabled:M,className:T?"ContactForm__update-btn":void 0,children:T?"Update contact":"Add new contact"})]})}var F=n(24);function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return null!=e})).join(" ")}var D=function(e){var t=e.children,n=e.className,c=Object(p.a)(e,["children","className"]);return Object(a.jsx)("button",Object(O.a)(Object(O.a)({className:_("IconButton",n)},c),{},{children:t}))},S=Object(c.memo)((function(e){var t=e.contact,n=e.nameFilter,c=e.onDelete,r=function(e,t){var n;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var a=e.toLowerCase(),c=t.toLowerCase();n=a.indexOf(c)}else n=e.indexOf(t);if(n<0)return[e,"",""];var r=n+t.length;return[e.slice(0,n),e.slice(n,r),e.slice(n+t.length)]}(t.name,n,!0),o=Object(j.a)(r,3),s=o[0],i=o[1],l=o[2],u=i?Object(a.jsxs)("span",{children:[s,Object(a.jsx)("strong",{children:i}),l]}):t.name;return Object(a.jsxs)("li",{className:"ContactItem",children:[Object(a.jsxs)("div",{className:"ContactItem__info",children:[Object(a.jsx)("div",{className:"ContactItem__name",children:u}),Object(a.jsx)("div",{className:"ContactItem__phone",children:t.phoneNumber})]}),Object(a.jsx)("div",{className:"ContactItem__buttons",children:Object(a.jsx)(D,{className:"IconButton--red",onClick:function(){window.confirm("Do you really want to delete ".concat(t.name,"?"))&&c(t.id)},children:Object(a.jsx)(F.a,{})})})]},t.name)}));var k=Object(c.memo)((function(e){var t=e.contacts,n=e.nameFilter,c=e.onDelete,r=function(e,t){var n=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(n)}))}(t,n);return 0===r.length?Object(a.jsx)("p",{className:"ContactList--empty",children:n?"No matches":"The contact list is empty."}):Object(a.jsx)("ul",{className:"ContactList",children:r.map((function(e){return Object(a.jsx)(S,{contact:e,nameFilter:n,onDelete:c},e.name)}))})}));function I(e){var t=e.contacts,n=e.onDelete,r=Object(c.useState)(""),o=Object(j.a)(r,2),s=o[0],i=o[1];return Object(a.jsxs)("div",{className:"ContactListWithFilter",children:[Object(a.jsx)("div",{className:"ContactListWithFilter__header",children:Object(a.jsx)("input",{type:"text",value:s,placeholder:"Filter by name...",onChange:function(e){var t=e.target.value;i(t)}})}),Object(a.jsx)(k,{contacts:t,nameFilter:s,onDelete:n})]})}function L(e){return e.sort((function(e,t){return e.name.localeCompare(t.name)}))}function A(e){if(function(e){return e.response&&e.response.data}(e)){var t=e.response.data;if(t.message)return t.message;if(t.errors&&t.errors.length>0)return t.errors[0].message}return e.message}function E(){var e=Object(c.useState)("loading"),t=Object(j.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)([]),s=Object(j.a)(o,2),i=s[0],m=s[1],O=Object(c.useState)(null),p=Object(j.a)(O,2),v=p[0],x=p[1],g=function(){h.a.get(f).then((function(e){return e.data})).then((function(e){m(L(e)),r("ready")})).catch((function(e){r("error"),x("Error while trying to fetch data from the server.\n"+"Details: ".concat(e.message))}))},N=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t,h.a.post(f,n).then((function(e){return e.data}))).then((function(e){var t=[].concat(Object(u.a)(i),[e]);m(L(t)),b.b.success("".concat(e.name," was saved"),{autoClose:3e3})})).catch((function(e){console.error(e);var n=A(e);b.b.error('Failed to add "'.concat(t.name,'". Details:  ').concat(n))}));case 1:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)(g,[]);var y=null;if("ready"===n)y=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(T,{className:"add-item-panel",children:Object(a.jsx)(w,{contacts:i,onAddNew:N,onUpdate:function(e){var t;(t=e,h.a.put("".concat(f,"/").concat(t.id),t).then((function(e){return e.data}))).then((function(t){console.log(t);var n=i.findIndex((function(t){return t.id===e.id})),a=function(e,t,n){return[].concat(Object(u.a)(e.slice(0,t)),[n],Object(u.a)(e.slice(t+1)))}(i,n,t);m(L(a)),b.b.success('The number of "'.concat(t.name,'" was successfully updated.'))})).catch((function(t){console.error(t),b.b.error('Failed to update "'.concat(e.name,'". Details: ').concat(A(t)))}))}})}),Object(a.jsx)(T,{className:"contact-list-panel",children:Object(a.jsx)(I,{contacts:i,onDelete:function(e){var t=i.find((function(t){return t.id===e}));(function(e){return h.a.delete("".concat(f,"/").concat(e))})(e).then((function(n){m(i.filter((function(t){return t.id!==e}))),b.b.success('"'.concat(t.name,'" was successfully deleted.'))})).catch((function(e){var n;if(console.log(e),e.response&&404===e.response.status)g(),n='It seems "'.concat(t.name,'" had already been deleted.')+" You were using a stale tab, but now you're okay!";else{var a=A(e);n='Failed to delete "'.concat(t.name,'". Details: ').concat(a)}b.b.error(n)}))}})})]});else if("loading"===n)y=null;else{if("error"!==n)throw new Error("invalid state");y=Object(a.jsx)("p",{style:{color:"red"},children:v})}return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(b.a,{}),Object(a.jsx)("h1",{className:"header",children:"PhoneBook"}),Object(a.jsx)("div",{className:"content",children:y})]})}var T=function(e){var t=e.className,n=e.children,c="Panel"+(" "+t||!1);return Object(a.jsx)("div",{className:c,children:n})};s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(E,{})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.c03833d7.chunk.js.map